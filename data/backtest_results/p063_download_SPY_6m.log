2025-12-18 19:02:07,622 - INFO - ========================================================================================
2025-12-18 19:02:07,622 - INFO - P0.6.3 WINDOWED DOWNLOADER | SPY | provider=polygon
2025-12-18 19:02:07,622 - INFO - Range: 2025-06-01 → 2025-12-01 | window_days=7
2025-12-18 19:02:07,622 - INFO - Out: /app/data/historical/1m/SPY.parquet
2025-12-18 19:02:07,622 - INFO - ========================================================================================
2025-12-18 19:02:07,623 - INFO - [window 1/27] 2025-06-01 → 2025-06-08
2025-12-18 19:02:07,953 - INFO -   ok: 4195 bars (attempts=1)
2025-12-18 19:02:08,453 - INFO - [window 2/27] 2025-06-08 → 2025-06-15
2025-12-18 19:02:09,000 - INFO -   ok: 4311 bars (attempts=1)
2025-12-18 19:02:09,501 - INFO - [window 3/27] 2025-06-15 → 2025-06-22
2025-12-18 19:02:10,234 - INFO -   ok: 3498 bars (attempts=1)
2025-12-18 19:02:10,734 - INFO - [window 4/27] 2025-06-22 → 2025-06-29
2025-12-18 19:02:10,919 - INFO -   ok: 4312 bars (attempts=1)
2025-12-18 19:02:11,419 - INFO - [window 5/27] 2025-06-29 → 2025-07-06
2025-12-18 19:02:11,678 - INFO -   ok: 2993 bars (attempts=1)
2025-12-18 19:02:12,178 - INFO - [window 6/27] 2025-07-06 → 2025-07-13
2025-12-18 19:02:12,224 - WARNING -   tentative 1/8 échouée: RuntimeError('polygon_rate_limited_429')
2025-12-18 19:02:12,224 - WARNING -   polygon 429 -> sleep 60.0s then retry
2025-12-18 19:03:12,659 - INFO -   ok: 4079 bars (attempts=2)
2025-12-18 19:03:13,159 - INFO - [window 7/27] 2025-07-13 → 2025-07-20
2025-12-18 19:03:13,354 - INFO -   ok: 4152 bars (attempts=1)
2025-12-18 19:03:13,855 - INFO - [window 8/27] 2025-07-20 → 2025-07-27
2025-12-18 19:03:14,055 - INFO -   ok: 4023 bars (attempts=1)
2025-12-18 19:03:14,555 - INFO - [window 9/27] 2025-07-27 → 2025-08-03
2025-12-18 19:03:14,753 - INFO -   ok: 4262 bars (attempts=1)
2025-12-18 19:03:15,253 - INFO - [window 10/27] 2025-08-03 → 2025-08-10
2025-12-18 19:03:15,296 - WARNING -   tentative 1/8 échouée: RuntimeError('polygon_rate_limited_429')
2025-12-18 19:03:15,296 - WARNING -   polygon 429 -> sleep 60.0s then retry
2025-12-18 19:04:15,511 - INFO -   ok: 4400 bars (attempts=2)
2025-12-18 19:04:16,011 - INFO - [window 11/27] 2025-08-10 → 2025-08-17
2025-12-18 19:04:16,299 - INFO -   ok: 4034 bars (attempts=1)
2025-12-18 19:04:16,799 - INFO - [window 12/27] 2025-08-17 → 2025-08-24
2025-12-18 19:04:17,083 - INFO -   ok: 4036 bars (attempts=1)
2025-12-18 19:04:17,583 - INFO - [window 13/27] 2025-08-24 → 2025-08-31
2025-12-18 19:04:17,640 - WARNING -   tentative 1/8 échouée: RuntimeError('polygon_rate_limited_429')
2025-12-18 19:04:17,640 - WARNING -   polygon 429 -> sleep 60.0s then retry
2025-12-18 19:05:17,868 - INFO -   ok: 4001 bars (attempts=2)
2025-12-18 19:05:18,368 - INFO - [window 14/27] 2025-08-31 → 2025-09-07
2025-12-18 19:05:18,529 - INFO -   ok: 3386 bars (attempts=1)
2025-12-18 19:05:19,030 - INFO - [window 15/27] 2025-09-07 → 2025-09-14
2025-12-18 19:05:19,244 - INFO -   ok: 3956 bars (attempts=1)
2025-12-18 19:05:19,744 - INFO - [window 16/27] 2025-09-14 → 2025-09-21
2025-12-18 19:05:19,913 - INFO -   ok: 4070 bars (attempts=1)
2025-12-18 19:05:20,413 - INFO - [window 17/27] 2025-09-21 → 2025-09-28
2025-12-18 19:05:20,583 - INFO -   ok: 3919 bars (attempts=1)
2025-12-18 19:05:21,084 - INFO - [window 18/27] 2025-09-28 → 2025-10-05
2025-12-18 19:05:21,126 - WARNING -   tentative 1/8 échouée: RuntimeError('polygon_rate_limited_429')
2025-12-18 19:05:21,126 - WARNING -   polygon 429 -> sleep 60.0s then retry
2025-12-18 19:06:21,367 - INFO -   ok: 4094 bars (attempts=2)
2025-12-18 19:06:21,868 - INFO - [window 19/27] 2025-10-05 → 2025-10-12
2025-12-18 19:06:22,225 - INFO -   ok: 4099 bars (attempts=1)
2025-12-18 19:06:22,725 - INFO - [window 20/27] 2025-10-12 → 2025-10-19
2025-12-18 19:06:22,901 - INFO -   ok: 4402 bars (attempts=1)
2025-12-18 19:06:23,401 - INFO - [window 21/27] 2025-10-19 → 2025-10-26
2025-12-18 19:06:23,568 - INFO -   ok: 4115 bars (attempts=1)
2025-12-18 19:06:24,068 - INFO - [window 22/27] 2025-10-26 → 2025-11-02
2025-12-18 19:06:24,299 - INFO -   ok: 4273 bars (attempts=1)
2025-12-18 19:06:24,799 - INFO - [window 23/27] 2025-11-02 → 2025-11-09
2025-12-18 19:06:24,841 - WARNING -   tentative 1/8 échouée: RuntimeError('polygon_rate_limited_429')
2025-12-18 19:06:24,841 - WARNING -   polygon 429 -> sleep 60.0s then retry
2025-12-18 19:07:25,058 - INFO -   ok: 4661 bars (attempts=2)
2025-12-18 19:07:25,558 - INFO - [window 24/27] 2025-11-09 → 2025-11-16
2025-12-18 19:07:25,742 - INFO -   ok: 4566 bars (attempts=1)
2025-12-18 19:07:26,242 - INFO - [window 25/27] 2025-11-16 → 2025-11-23
2025-12-18 19:07:26,422 - INFO -   ok: 4688 bars (attempts=1)
2025-12-18 19:07:26,922 - INFO - [window 26/27] 2025-11-23 → 2025-11-30
2025-12-18 19:07:27,093 - INFO -   ok: 3297 bars (attempts=1)
2025-12-18 19:07:27,594 - INFO - [window 27/27] 2025-11-30 → 2025-12-01
2025-12-18 19:07:27,644 - WARNING -   fenêtre vide (2025-11-30 → 2025-12-01)
2025-12-18 19:07:27,644 - WARNING -   skip: no data
2025-12-18 19:07:28,798 - INFO - 
✅ wrote parquet: /app/data/historical/1m/SPY.parquet
2025-12-18 19:07:28,798 - INFO - ✅ wrote quality report: /app/data/historical/1m/data_quality_SPY.json
2025-12-18 19:07:28,798 - INFO - duplicates removed: 0
2025-12-18 19:07:28,798 - INFO - quality passed: True | corrupted_days=6
